// Copyright (c) 2025 sw.consulting
// This file is a part of Media Pi device agent application

polkit.addRule(function(action, subject) {
  const allowed = ['nginx.service','my-app.service'];
  const isPi = subject.isInGroup('svc-ops') || subject.user == 'pi';
  const actions = [
    'org.freedesktop.systemd1.manage-units',
    'org.freedesktop.systemd1.manage-unit-files'
  ];
  if (!isPi || actions.indexOf(action.id) === -1) return;
  const unit = action.lookup('unit');
  if (unit && allowed.indexOf(unit) !== -1) {
    return polkit.Result.YES;
  }
});
